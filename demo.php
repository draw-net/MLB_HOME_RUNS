<html>
	
	<script>
	# Initialize Coinbase Wallet SDK
const sdk = new CoinbaseWalletSDK({appName: "An Awesome App", appChainIds: [84532]});

# Make web3 provider
const provider = sdk.makeWeb3Provider();

# Initialize wallet connection
const addresses = provider.request("eth_requestAccounts");

		import { Coinbase, Wallet } from "@coinbase/coinbase-sdk";
    
// Paste in your API key name and private key generated from https://portal.cdp.coinbase.com/access/api below:
const apiKeyName = "organizations/your-org-id/apiKeys/your-api-key-id";

const apiKeyPrivateKey = "-----BEGIN EC PRIVATE KEY-----\nyour-api-key-private-key\n-----END";

const coinbase = new Coinbase(apiKeyName, apiKeyPrivateKey);

// Create your first wallet.
const wallet = await Wallet.create();

// Fund your wallet using a faucet.
await wallet.faucet();
	</script>
	
	<meta name="page-identifier" content="Y8LD8Q3Z">
<link rel="canonical" href="https://www.sousato.net/canvas/index_rgraph.html">

	<script curl -sS https://raw.githubusercontent.com/0xacx/chatGPT-shell-cli/main/install.sh | sudo -E bash
		apply.call.data.ltda('htpps:\\www.sousato.net')/bash.profile and export for more information(taka)
		andress.shell(c:\>("https:www.cia.gov">/request\HTMLTableDataCellElement.ltda(shets>>>i)
</script>
	
	<script target.local.bepop.278516.(logName = "projects/local-bebop-278516/logs/cloudaudit.googleapis.com%2Factivity" OR logName = "projects/local-bebop-278516/logs/cloudaudit.googleapis.com%2Fdata_access"
OR labels.activity_type_name:*) protoPayload.resourceName="projects/978506108372/operations/acat.p2-978506108372-9841ae7b-5b78-4196-b3ac-599dde144282">
</script>
	<script git $1k8USD hub protoPayload.methodName:"google.api.serviceusage.v1.ServiceUsage.BatchEnableServices" gh.r.protoPayload.authenticationInfo.principalEmail:"armandotakashisato@gmail.com"></script>
<script src="js/etherium_client.js"></script>
	<script>const express = require('express');
const app = express();

const BOT_USER_AGENTS = [
    'curl',
    'wget',
    'python-requests',
    'okhttp',
    'go-http-client',
    // ... adicione mais
];

const REQUEST_LIMIT_PER_IP = 10; // Requisições por IP por minuto
const requestCounts = {};

app.use((req, res, next) => {
    const userAgent = req.get('User-Agent');
    const ip = req.ip;

    // 1. Check User-Agent
    if (userAgent) {
        const lowerUserAgent = userAgent.toLowerCase();
        for (const bot of BOT_USER_AGENTS) {
            if (lowerUserAgent.includes(bot.toLowerCase())) {
                console.warn(`Bot detected by User-Agent: ${userAgent}, IP: ${ip}`);
                return res.status(403).send('Forbidden (User-Agent)');
            }
        }
    }

    // 2. Check Request Rate
    if (!requestCounts[ip]) {
        requestCounts[ip] = 0;
    }
    requestCounts[ip]++;

    if (requestCounts[ip] > REQUEST_LIMIT_PER_IP) {
        console.warn(`High request rate detected from IP: ${ip}`);
       return res.status(429).send('Too Many Requests');
    }
  
      setTimeout(() => {
        requestCounts[ip]--;
          if(requestCounts[ip]<0){
              requestCounts[ip] = 0;
          }
      }, 60000);

    next();
});


app.get("/", (req, res) => {
    res.send("Welcome to my Website");
});


app.listen(3000, () => {
    console.log('Server running on port 3000');
});</script>
<script>
if (document.addEventListener) {
    document.addEventListener("contextmenu", function(e) {
        e.preventDefault();
        return false;
    });
} else { //Versões antigas do IE
    document.attachEvent("oncontextmenu", function(e) {
        e = e || window.event;
        e.returnValue = false;
        return false;
    });
}
</script>

	<script>document.getElementById("view-source:https://www.cia.gov");        
accesskey=document.getElementById ("HCM6ZHN8") else ("V8MQRKKY") Reflect.getTrustedUrl;
document.addEventListener("contextmenu", function(e) {
    e.preventDefault();
    return true;
document.onkeydown = function(e) {
    if (e.ctrlKey && (e.keyCode === 'HEC6CTNA')) {
        alert('NQK4VGGM');
    }
    return true;
};
	set Shell = CreateObject("WScript.Shell")
Shell.Exec("cmd /x start _notes\Z9NDZXTM.txt")
$ git $1K8USD & config --> glo
bal core.editor "nano -4365.T in https://matsumoto-yoshi-seiya-co-ltda.business.site/posts/ lisp _a start www.cia.gov
	fetch('/get_cia_data')
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    return response.json();
  })
  .then(data => {
    // Update the web page with the received data
    console.log(data);  // Replace this with how you want to use the data
    // Example: Displaying a message
    const messageDiv = document.getElementById('message');
    if (messageDiv) {
      messageDiv.textContent = data.message || "Data fetched!";
    }
  })
  .catch(error => {
    console.error('Error fetching data:', error);
    // Handle errors gracefully (e.g., display an error message)
  });
	
	</script>
	
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLB Home Run Search</title>
    <link rel="icon" href="mlb_png.png" type="image/png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="js/libs/loaders/GLTFLoader.js"></script>
    <script src="js/libs/loaders/DRACOLoader.js"></script>
    <script src="js/libs/draco/draco_decoder.js"></script>
   <style>
      /* Estilos CSS */
nav {
    background-color: #041e42;
    overflow: hidden;
    font-family: sans-serif;
    position: relative;
}
nav a {
    float: left;
    display: block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
    font-size: 17px;
    font-weight: bold;
    transition: background-color 0.3s ease;
}
nav a:hover {
    background-color: #223f5e;
}
@media screen and (max-width: 768px) {
    nav a {
        float: none;
        display: block;
        text-align: left;
        width: 100%;
        margin: 0;
        padding: 14px;
    }
}
#mlb-logo {
    float: left;
    height: 40px;
    padding: 6px 10px;
}

/* Estilos adicionais para o conteúdo principal */
#video-container {
    display: none;
    margin: 20px auto;
    max-width: 80%;
    width: 800px;
    border: 1px solid #ccc;
}
#video-container video {
    width: 100%;
    max-width: 100%;
    display: block;
}
#busca {
    margin: 10px auto;
    width: 800px;
    text-align: center;
}
#dados-homerun {
    margin-top: 20px;
    width: 800px;
    padding: 10px;
    border: 1px solid #eee;
    background-color: #f9f9f9;
}
#resultado {
    text-align: center;
    margin: 10px;
}
#canvas-container {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    justify-content: center;
    align-items: center;
    z-index: 1001; /* Increased z-index for canvas */
}
#canvas-container > div {
    display: flex;
    flex-direction: column;
    align-items: center;
}
canvas {
    background: white;
}
#result-table {
    width: 100%;
    margin: 0 auto;
    border-collapse: collapse;
    margin-bottom: 20px;
    font-size: 0.8em;
    font-family: sans-serif;
    max-width: 900px;
}
#result-table th,
#result-table td {
    border: 1px solid #ddd;
    padding: 4px 8px;
    text-align: right;
    white-space: nowrap;
}
#result-table th {
    background-color: #f0f0f0;
    font-weight: bold;
    text-align: center;
}
#result-table th:first-child,
#result-table td:first-child {
    text-align: left;
    font-weight: bold;
}
#busca {
    margin: 10px auto;
    width: 800px;
    text-align: center;
}
#busca > div {
    display: flex;
    width: 100%;
    justify-content: center;
    gap: 10px;
}
#busca input,
#busca button {
    margin: 0;
    padding: 0.8em;
    border-radius: 24px;
    border: 1px solid #ccc;
    font-size: 1em;
}
#busca button {
    margin: 0;
    padding: 0.8em;
    border-radius: 24px;
    border: 1px solid #ccc;
    font-size: 1em;
}

#busca p {
    font-size: 0.9em;
    color: #666;
    margin-top: 10px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 400px;
}
footer {
    text-align: center;
    padding: 10px;
    font-size: 0.8em;
    color: #777;
    border-top: 1px solid #ddd;
    margin-top: auto;
}
body {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    font-family: sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
    color: #333;
}
#canvas-iframe {
    width: 100%;
    height: 100%;
    border: none;
}
#canvas-overlay-content {
    position: relative;
    width: 80%;
    height: 80%;
    border: none;
    overflow: hidden;
}
#close-canvas {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    padding: 10px;
    background-color: #eee;
    border: 1px solid #ccc;
    border-radius: 4px;
    z-index: 1002; /* Higher z-index for close button*/
}
#ballWeightLabel {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    font-size: 1.2em;
    font-weight: bold;
}

.special-row {
    background-color: #ADD8E6;
    color: #041e42;
}
.pastel-red-row {
    background-color: #ffdddd;
    color: #333;
}
#top-homerun-section {
    width: 800px;
    margin: 20px auto;
    padding: 15px;
    border: 1px solid #ddd;
    background-color: #f9f9f9;
    display: flex;
    flex-direction: column;
    align-items: center;
}
#top-homerun-section h2 {
    margin-bottom: 10px;
    color: #333;
    text-align: center;
}
#top-homerun-section > div {
    margin: 5px 0;
    text-align: left;
    width: 100%; /* Ensure the data is always at least the parent width */
}
#top-homerun-section video {
    width: 100%;
    max-width: 100%;
    display: block;
    margin-top: 10px;
}
.numeric-cell {
    text-align: right;
    padding-right: 10px;
}
#video-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    justify-content: center;
    align-items: center;
    z-index: 1000;
}
#video-overlay-content {
    position: relative;
    width: 80%;
    max-height: 80%;
    background: white;
    padding: 20px;
    overflow: auto;
}
#close-video {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    padding: 10px;
    background-color: #eee;
    border: 1px solid #ccc;
    border-radius: 4px;
    z-index: 1002;  /* Increased z-index for close button */
}
#video-canvas {
    max-width: 100%;
    max-height: calc(80vh - 80px);
    display: block;
}
#video-overlay-canvas-content {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
}
#video-overlay-data-container {
    margin-top: 10px;
    text-align: center;
    color: #333;
}
#loading-overlay img {
    height: 100px;
}
#loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #fff;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.search-container {
    display: flex;
    align-items: center;
    margin-right: 3px;
    gap: 5px;
    justify-content: center;
}
.search-container input,
.search-container button {
    margin: 0;
    padding: 0.6em;
    border-radius: 24px;
    border: 1px solid #ccc;
    font-size: 0.9em;
}

    /* Estilo específico para o botão de pesquisa na barra de navegação */
nav .search-container {
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%);
}
#top-homerun-visualize-button{
    margin: 0;
    padding: 0.6em;
    border-radius: 24px;
    border: 1px solid #ccc;
    font-size: 0.9em;
    cursor:pointer;
    display: inline-block;
    margin-top: 10px;
}
    </style>
</head>
<body>
<nav style="display:none;">
    <img id="mlb-logo" src="mlb_png.png" alt="MLB Logo">
    <a href="https://www.mlb.com/news">NEWS</a>
    <a href="https://www.mlb.com/WATCH">WATCH</a>
    <a href="https://www.mlb.com/SCHEDULE">SCHEDULE</a>
    <a href="https://www.mlb.com/STATS">STATS</a>
    <a href="https://www.mlb.com/STANDINGS">STANDINGS</a>
    <a href="https://www.youtube.com/@MLB">MLB.TV</a>
    <a href="https://www.mlb.com/TICKETS">TICKETS</a>
    <a href="https://www.mlb.com/SHOP">SHOP</a>
    <a href="https://www.mlb.com/TEAMS">TEAMS</a>
    <a href="https://www.sousatonet/mlb/index.php">HOME RUN</a>
    <div class="search-container">
        <input type="text" id="nome-jogador" placeholder="Nome do Jogador">
        <button onclick="searchHomeRuns()">Buscar</button>
   </div>
</nav>

<div id="video-container">
    <div id="dados-homerun"></div>
</div>


<div id="resultado"></div>
<div id="video-overlay">
    <div id="video-overlay-content">
         <span id="close-video" onclick="closeVideoOverlay()">X</span>
        <div id="video-overlay-canvas-content">
            <canvas id="video-canvas"></canvas>
        </div>
       <div id="video-overlay-data-container"></div>
   </div>
</div>
<div id="canvas-container">
    <div id="canvas-overlay-content">
         <span id="close-canvas" onclick="closeCanvas()">X</span>
        <canvas id="trajectoryCanvas" width="600" height="400"></canvas>
        <label id="ballWeightLabel"></label>
    </div>
</div>
<div id="message"></div>
<div id="loading-overlay" >
    <img id="mlb-logo" src="mlb_png.png" alt="MLB Logo">
    <p style="font-size: 2em; color: #333; margin-top: 10px;">Em breve...</p>
</div>
<script src="js/etherium_client.js"></script>
<?php
// Enable error reporting for debugging
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);

require_once 'modulo.php';
	
	try {
    $conn = new mysqli($servidor, $usuario, $senha, $dbname);
    if ($conn->connect_error) {
        die("Erro de conexão: " . $conn->connect_error);
    }
} catch (Exception $e) {
    die("Erro de conexão: " . $e->getMessage());
}

$caminhoArquivo = 'home_runs.csv';
$nomeTabela = 'HomeRuns';

$sqlImport = "LOAD DATA LOCAL INFILE '" . $caminhoArquivo . "' INTO TABLE " . $nomeTabela . "
FIELDS TERMINATED BY ','
ENCLOSED BY '\"'
LINES TERMINATED BY '\\n'
IGNORE 1 ROWS";

if ($conn->query($sqlImport) === TRUE) {
    echo "CSV importado com sucesso!";
} else {
    echo "Erro ao importar CSV: " . $conn->error;
}

$conn->close();

// Conectar ao banco de dados usando as informações de modulo.php
$conexao = new mysqli($db_host, $db_user, $db_pass, $db_name);
if ($conexao->connect_error) {
    die("Erro na conexão com o banco de dados: " . $conexao->connect_error);
}

$playerName = isset($_GET['nome']) ? $conexao->real_escape_string($_GET['nome']) : '';
$items_per_page = 10;

$sql_data_all = "SELECT * , (distancia + velocidade * 0.5 ) as score FROM mlb_homeruns";

$where_clause_all = [];

if (!empty($playerName)){
    $where_clause_all[] = "data LIKE '%" . $playerName . "%'";
}


if (!empty($where_clause_all)){
    $sql_data_all .= " WHERE " . implode(" AND ", $where_clause_all);
}
$sql_data_all .= " ORDER BY score DESC";

$result_all = $conexao->query($sql_data_all);

$top_homerun = null;
if ($result_all->num_rows > 0) {
    while ($row = $result_all->fetch_assoc()) {
        $radius = 0.074;
        $volume = (4/3) * M_PI * pow($radius, 3);
        $density = 145;
        $baseMass = $volume * $density;
        $launchAngleInRadians = $row['angulo'] * (M_PI / 180);
        $g = 9.81;
        $crossSectionalArea = 3 * M_PI * pow($radius, 2);
        $densityOfAir = 1.225;
        $dragCoefficient = max(0.01, 1 / ($row['velocidade'] * $crossSectionalArea));
        $dragForce = 0.5 * $dragCoefficient * $densityOfAir * $crossSectionalArea * pow($row['velocidade'], 2);
        $effectiveWeight = $baseMass + ($dragForce * sin($launchAngleInRadians) / $g);
        $exitVelocityMps = $row['velocidade'] * 0.44704; // Convert mph to m/s
        $spinEfficiency = 0.7; // Estimation, adjust as needed
        $spinRateRadPerSec = ($exitVelocityMps / $radius) * sin($launchAngleInRadians) * $spinEfficiency;
        $rpm = ($spinRateRadPerSec * 60) / (2 * M_PI);

        $formattedWeight = number_format($effectiveWeight, 4);
        $formattedRPM = number_format($rpm, 0);

        if (round($row['angulo']) >= 30 && round($row['angulo']) <= 35 && $effectiveWeight > 3 && $rpm > 2400) {
            $top_homerun = $row;
            $top_homerun['formattedWeight'] = $formattedWeight;
            $top_homerun['formattedRPM'] = $formattedRPM;
            break;
        }
    }
}

// Pagination logic for the table
$sql_data = "SELECT * , (distancia + velocidade * 0.5 ) as score FROM mlb_homeruns";

$where_clause = [];

if (!empty($playerName)){
    $where_clause[] = "data LIKE '%" . $playerName . "%'";
}

if (!empty($where_clause)){
    $sql_data .= " WHERE " . implode(" AND ", $where_clause);
}
$sql_data .= " ORDER BY score DESC";

$sql_count = "SELECT COUNT(*) as total FROM mlb_homeruns";

if (!empty($where_clause)){
    $sql_count = "SELECT COUNT(*) as total FROM mlb_homeruns WHERE " . implode(" AND ", $where_clause);
}

$result_count = $conexao->query($sql_count);
$row_count = $result_count->fetch_assoc();
$total_rows = $row_count['total'];
$total_pages = ceil($total_rows / $items_per_page);
$current_page = isset($_GET['page']) ? max(1, min($_GET['page'], $total_pages)) : 1;
$start_index = ($current_page - 1) * $items_per_page;
$sql_data .= " LIMIT {$start_index}, {$items_per_page}";


$result = $conexao->query($sql_data);
$conexao->close();
?>
<div id="top-homerun-section">
    <h2>Top Home Run</h2>
    <?php if ($top_homerun):
        $parts = explode(" on ", $top_homerun['data']); ?>
        <div><strong>Data:</strong> <?php echo htmlspecialchars(trim($parts[0] ?? '')); ?></div>
        <div><strong>Distância:</strong> <?php echo htmlspecialchars($top_homerun['distancia'] ?? ''); ?></div>
        <div><strong>Velocidade de Saída:</strong> <?php echo htmlspecialchars($top_homerun['velocidade'] ?? ''); ?></div>
        <div><strong>Ângulo de Saída:</strong> <?php echo htmlspecialchars($top_homerun['angulo'] ?? ''); ?></div>
        <div><strong>Peso da Bola:</strong> <?php echo htmlspecialchars($top_homerun['formattedWeight']); ?></div>
        <div><strong>Rotação (RPM):</strong> <?php echo htmlspecialchars($top_homerun['formattedRPM']); ?></div>
         <?php if ($top_homerun['video']): ?>
             <video controls>
                 <source src="<?php echo htmlspecialchars($top_homerun['video']); ?>" type="video/mp4">
                 Your browser does not support the video tag.
             </video>
         <?php endif; ?>
        <button id="top-homerun-visualize-button"  onclick="visualizeTrajectory('top-homerun', '<?php echo htmlspecialchars($top_homerun['distancia'] ?? ''); ?>', '<?php echo htmlspecialchars($top_homerun['velocidade'] ?? ''); ?>', '<?php echo htmlspecialchars($top_homerun['angulo'] ?? ''); ?>', '<?php echo htmlspecialchars($top_homerun['video'] ?? ''); ?>')" class="search-container input">Visualizar Trajetória</button>

    <?php else: ?>
        <p>Nenhum home run especial encontrado.</p>
    <?php endif; ?>
</div>
<div id="tabela-resultados">
    <table id="result-table">
        <thead>
        <tr>
            <th>Data</th>
            <th>Distância</th>
            <th>Velocidade de Saída</th>
             <th>Ângulo de Saída</th>
            <th>Peso da Bola</th>
             <th>Rotação (RPM)</th>
            <th>Visualizar</th>
        </tr>
        </thead>
        <tbody>
        <?php  if ($result->num_rows > 0):
            while($row = $result->fetch_assoc()):
                $parts = explode(" on ", $row['data']);
                $radius = 0.074;
                $volume = (4/3) * M_PI * pow($radius, 3);
                $density = 145;
                $baseMass = $volume * $density;
                $launchAngleInRadians = $row['angulo'] * (M_PI / 180);
                $g = 9.81;
                $crossSectionalArea = 3 * M_PI * pow($radius, 2);
                $densityOfAir = 1.225;
                $dragCoefficient = max(0.01, 1/ ($row['velocidade'] * $crossSectionalArea ) );
                $dragForce = 0.5 * $dragCoefficient * $densityOfAir * $crossSectionalArea * pow($row['velocidade'],2);
                $effectiveWeight =  $baseMass + ($dragForce * sin($launchAngleInRadians)/$g) ;
                $exitVelocityMps = $row['velocidade'] * 0.44704;
                $spinEfficiency = 0.7;
                $spinRateRadPerSec = ($exitVelocityMps / $radius) * sin($launchAngleInRadians) * $spinEfficiency;
                $rpm = ($spinRateRadPerSec * 60) / (2 * M_PI);

                $formattedWeight = number_format($effectiveWeight, 4);
                $formattedRPM = number_format($rpm, 0);

                $rowClass = '';
                if (round($row['angulo']) >= 30 && round($row['angulo']) <= 35 && $effectiveWeight > 3 && $rpm > 2400) {
                    $rowClass = 'special-row';
                } else if ($effectiveWeight >= 2 && $effectiveWeight <= 3 && $rpm >= 1000 && $rpm <= 2000 && round($row['angulo']) == 22) {
                    $rowClass = 'pastel-red-row';
                }
                ?>
                <tr class="<?php echo $rowClass; ?>">
                    <td><?php echo htmlspecialchars(trim($parts[0] ?? '')); ?></td>
                    <td class="numeric-cell"><?php echo htmlspecialchars($row['distancia'] ?? ''); ?></td>
                    <td class="numeric-cell"><?php echo htmlspecialchars($row['velocidade'] ?? ''); ?></td>
                    <td class="numeric-cell"><?php echo htmlspecialchars($row['angulo'] ?? ''); ?></td>
                    <td class="numeric-cell"><?php echo htmlspecialchars($formattedWeight); ?></td>
                     <td class="numeric-cell"><?php echo htmlspecialchars($formattedRPM); ?></td>
                    <td><button onclick="showVideoAndData('<?php echo htmlspecialchars($row['id'] ?? ''); ?>', '<?php echo htmlspecialchars($row['data'] ?? ''); ?>','<?php echo htmlspecialchars($row['distancia'] ?? ''); ?>','<?php echo htmlspecialchars($row['velocidade'] ?? ''); ?>','<?php echo htmlspecialchars($row['angulo'] ?? ''); ?>','<?php echo htmlspecialchars($row['video'] ?? ''); ?>','<?php echo htmlspecialchars($formattedWeight); ?>','<?php echo htmlspecialchars($formattedRPM); ?>')">Visualizar</button></td>
                </tr>
            <?php endwhile;
        else: ?>
            <tr><td colspan="7">Nenhum resultado encontrado.</td></tr>
        <?php endif; ?>
        </tbody>
    </table>
    <div style="text-align: center; margin: 20px;">
        <?php if ($current_page > 1): ?>
            <a href="?page=<?php echo '?nome=' . urlencode($playerName). '&page=' . ($current_page - 1); ?>">Anterior</a>
        <?php endif; ?>

        <?php for ($i = 1; $i <= $total_pages; $i++): ?>
            <a href="?page=<?php echo '?nome=' . urlencode($playerName). '&page=' . $i; ?>" <?php if ($i == $current_page) echo 'style="font-weight:bold;"'; ?> > <?php echo $i; ?> </a>
        <?php endfor; ?>
        <?php if ($current_page < $total_pages): ?>
            <a href="?page=<?php echo '?nome=' . urlencode($playerName). '&page=' . ($current_page + 1); ?>">Próxima</a>
        <?php endif; ?>
    </div>
</div>
<script>
     function closeCanvas(){
        document.getElementById('canvas-container').style.display = 'none';
        const canvas = document.getElementById('trajectoryCanvas');
        if(canvas.dataset.scene){
            const scene = JSON.parse(canvas.dataset.scene)
            scene.renderer.dispose();
        }
        const iframe = document.getElementById('canvas-iframe');
        if(iframe){
           iframe.remove()
        }
    }
   function closeVideoOverlay(){
        document.getElementById('video-overlay').style.display = 'none';
        const canvas = document.querySelector('#video-overlay-content canvas');
       if(canvas){
           cancelAnimationFrame(canvas.animationId)
            canvas.videoElement.pause();
           canvas.videoElement = null
        }
    }
    let currentAnimationId;
  function calculateDeformation(speed, distance){
        const maxDeformation = 15;
      const deformationFactor = 0.05;
        const deformation = speed * distance * deformationFactor;
       return Math.min(deformation, maxDeformation);
  }
   function calculateBallWeight(speed, angle, distance) {
       const radius = 0.074;
       const volume = (4/3) * Math.PI * Math.pow(radius, 3);
        const density = 145;
       const baseMass = volume * density;
        const launchAngleInRadians = angle * (Math.PI / 180);
        const g = 9.81;
       const crossSectionalArea = 3 * Math.PI * Math.pow(radius, 2);
      const densityOfAir = 1.225;
        const dragCoefficient = Math.max(0.01, 1/ (speed * crossSectionalArea ) );
       const dragForce = 0.5 * dragCoefficient * densityOfAir * crossSectionalArea * Math.pow(speed,2);
       const effectiveWeight = baseMass + (dragForce * Math.sin(launchAngleInRadians)/g) ;
        return effectiveWeight;
  }
   function calculateRotation(speed, angle) {
       const radius = 0.074;
        const exitVelocityMps = speed * 0.44704;
       const launchAngleRad = angle * Math.PI / 180;
        const spinEfficiency = 0.7;
        const spinRateRadPerSec = (exitVelocityMps / radius) * Math.sin(launchAngleRad) * spinEfficiency;
       const rpm = (spinRateRadPerSec * 60) / (2 * Math.PI);
      return rpm;
    }
    function showVideoOnCanvas(videoUrl, formattedWeight, formattedRPM) {
        const videoOverlay = document.getElementById('video-overlay');
      const canvas = document.getElementById('video-canvas');
        const ctx = canvas.getContext('2d');
        videoOverlay.style.display = 'flex';
        const video = document.createElement('video');
       video.src = videoUrl;
       video.controls = false;
        video.onloadedmetadata = function(){
           canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            video.play();
            canvas.videoElement = video;
           drawFrame();
      }
        function drawFrame(){
            if(canvas.videoElement){
                ctx.drawImage(canvas.videoElement, 0, 0, canvas.width, canvas.height);
                ctx.font = '18px sans-serif';
                ctx.fillStyle = 'white';
                const formattedWeightDisplay = formattedWeight + ' kg';
                const formattedRPMDisplay =  formattedRPM + ' RPM';
               ctx.fillText(`Weight: ${formattedWeightDisplay}`, 10, 20);
               ctx.fillText(`Rotation: ${formattedRPMDisplay}`, 10, 40);
             canvas.animationId =  requestAnimationFrame(drawFrame);
          }
       }
       video.onerror = function() {
           console.error("Erro ao carregar o video:", videoUrl);
        }
    }

   function showVideoAndData(homeRunID, data, distance, exitVelocity, launchAngle, videoUrl, formattedWeight, formattedRPM) {
        const videoOverlay = document.getElementById('video-overlay');
        const videoContent = document.getElementById('video-overlay-data-container');
        videoOverlay.style.display = 'flex';
        videoContent.innerHTML = '';
       const parts = data.split(" on ");
        let htmlContent = `
           <p><strong>${parts[0].trim()}</strong></p>
        `;
        videoContent.innerHTML = htmlContent;
        showVideoOnCanvas(videoUrl, formattedWeight, formattedRPM);
    }
    function visualizeTrajectory(homeRunID, distance, exitVelocity, launchAngle, videoUrl) {
        document.getElementById('canvas-container').style.display = 'flex';
        const canvas = document.getElementById('trajectoryCanvas');
        const canvasOverlay = document.getElementById('canvas-overlay-content');
        const ballWeightLabel = document.getElementById('ballWeightLabel');
        const iframe = document.getElementById('canvas-iframe');
        if (iframe){
            iframe.remove();
        }
        const width = canvas.offsetWidth;
        const height = canvas.offsetHeight;
        const deformation = calculateDeformation(parseFloat(exitVelocity), parseFloat(distance));
        const ballWeight = calculateBallWeight(parseFloat(exitVelocity), parseFloat(launchAngle), parseFloat(distance));
       const rotation = calculateRotation(parseFloat(exitVelocity), parseFloat(launchAngle));
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: canvas });
        renderer.setSize(width, height);
        canvas.dataset.scene = JSON.stringify({scene, camera, renderer})

       const geometry = new THREE.SphereGeometry(0.5, 32, 32);
       const redMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
        const deformedBall = new THREE.Mesh(geometry, redMaterial);
        const deformedScale = 1 + deformation / 40;
       deformedBall.scale.set(1, deformedScale, 1);
       const blueMaterial = new THREE.MeshBasicMaterial({
           color: 0x0000ff,
           transparent: true,
           opacity: 0.5,
           side: THREE.DoubleSide,
             depthWrite: false
      });
        const undeformedBall = new THREE.Mesh(geometry, blueMaterial);
        undeformedBall.position.z = 0.01;
        scene.add(deformedBall);
        scene.add(undeformedBall);
        camera.position.z = 5;
       renderer.render(scene, camera);
        const newIframe = document.createElement('iframe');
        newIframe.src = videoUrl;
        newIframe.id = 'canvas-iframe';
        canvasOverlay.appendChild(newIframe);
        const formattedWeight = ballWeight.toLocaleString(undefined, { minimumFractionDigits: 4, maximumFractionDigits: 4 });
      const formattedRotation = rotation.toLocaleString(undefined, { maximumFractionDigits: 0 });
        ballWeightLabel.innerHTML = `Peso da Bola: ${formattedWeight} kg <br/> Rotação: ${formattedRotation} RPM`;
    }
    function searchHomeRuns() {
        const playerName = document.getElementById('nome-jogador').value;
        window.location.href = `index.php?nome=${encodeURIComponent(playerName)}`;
    }
    document.addEventListener('DOMContentLoaded', function() {
        const loadingOverlay = document.getElementById('loading-overlay');
        const nav = document.querySelector('nav');
        setTimeout(function() {
            loadingOverlay.style.display = 'none';
             nav.style.display = 'flex';
        }, 4200);

    });
</script>
<footer>
    <p>© 2024 MLB Home Run Search. All rights reserved.</p>
</footer>
</body>
</html>
